---
import type { CollectionEntry } from "astro:content";
import FormattedDate from "../components/FormattedDate.astro";
import Layout from "./Layout.astro";

type Props = CollectionEntry<"blog">["data"];

const { title, description, pubDate, updatedDate, heroImage } = Astro.props;

// Get the slug from the URL
const slug = Astro.url.pathname.split("/").pop() || Astro.params.slug;
---

<style>
  .container {
    max-width: 720px;
    padding-top: 2rem;

    .hero-image {
      max-height: 700px;
      overflow: hidden;
      box-shadow:
        rgba(0, 0, 0, 0.1) 0px 4px 16px,
        rgba(0, 0, 0, 0.1) 0px 8px 32px;
    }
    img {
      display: block;
      box-sizing: border-box;
      height: auto;
      width: 100%;
      object-fit: contain;
      object-position: center;
      box-shadow: var(--box-shadow);
      border-radius: 0 !important;
    }

    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
      color: white;
      font-weight: 600;
      margin-top: 2rem;
      margin-bottom: 1rem;
    }

    p {
      margin-bottom: 2rem;
      color: rgb(187, 187, 187);
    }

    p > code,
    td > code,
    li > code {
      background: rgba(255, 255, 255, 0.106);
      padding: 0.15rem 0.4rem;
      color: aliceblue;
    }

    p > img {
      max-height: 400px;
      width: auto;
      max-width: 100%;
      margin: 0 auto;
    }

    p > a {
      color: var(--brand-link-color);
      text-decoration: underline;
    }

    pre {
      box-shadow: var(--box-shadow);
      max-height: 800px;
    }
  }
</style>

<Layout>
  <div class="container">
    <a 
      href="/blog" 
      class="inline-flex items-center gap-2 text-foreground-muted hover:text-white transition-colors mb-8"
    >
      <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M10 12L6 8L10 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      Back
    </a>
    
    <article>
      {
        heroImage && (
          <div class="hero-image w-3/4 mb-4">
            <img
              width={1020}
              height={510}
              src={heroImage}
              alt=""
              transition:name={`blog-hero-${slug}`}
            />
          </div>
        )
      }
      <h1 class="max-w-3xl mb-6 md:text-5xl!">{title}</h1>
      <div class="prose max-w-prose">
        <div class="title mb-12">
          <div class="date">
            <FormattedDate date={pubDate} />
            {
              updatedDate && (
                <div class="last-updated-on">
                  Last updated on <FormattedDate date={updatedDate} />
                </div>
              )
            }
          </div>
          <hr class="text-lines! mt-2" />
        </div>
        <slot />
      </div>
    </article>
  </div>
</Layout>
