---
import { getModuleData } from "../../lib/ayezee-cms-helper";

let testimonials = [];
try {
  const testimonialData = await getModuleData(
    import.meta.env.PUBLIC_TESTIMONIALS_KEY
  );
  testimonials = testimonialData.data;
} catch (error) {
  console.warn("Failed to load testimonials:", error);
  // Fallback testimonials for when CMS is unavailable
  testimonials = [
    {
      data: {
        testimonial:
          "Aaron delivered exceptional work on our project. His attention to detail and technical expertise made all the difference.",
        customer_name: "John Smith",
        customer_title: "Owner, Tech Solutions Inc.",
      },
    },
    {
      data: {
        testimonial:
          "Professional, reliable, and skilled developer. Would definitely work with Aaron again.",
        customer_name: "Sarah Johnson",
        customer_title: "Owner, Creative Digital Agency",
      },
    },
  ];
}
---

<div
  class="relative bg-[linear-gradient(to_bottom,transparent_0%,black_10%,black_90%,transparent_100%)] py-20"
>
  <div class="container">
    <div class="flex text-foreground-muted gap-4 items-center mb-12">
      <p class="text-white">
        <span class="text-primary">//</span> what clients say
      </p>
      <div class="h-px bg-lines flex-1"></div>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-8 gap-8 md:gap-6">
      {
        testimonials.map((testimonial: any) => (
          <div class="col-span-1 md:col-span-8 grid grid-cols-1 md:grid-cols-8 gap-6 border-b border-lines pb-8 last:border-b-0">
            <div class="col-span-1 md:col-span-5">
              <p class="text-foreground-muted text-lg leading-relaxed">
                "{testimonial.data.testimonial}"
              </p>
            </div>
            <div class="col-span-1 md:col-span-3 flex flex-col justify-end">
              <p class="text-white font-medium">
                {testimonial.data.customer_name}
              </p>
              <p class="text-foreground-muted text-sm">
                {testimonial.data.customer_title}
              </p>
            </div>
          </div>
        ))
      }
    </div>
  </div>
</div>
