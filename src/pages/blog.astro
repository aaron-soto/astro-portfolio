---
import Layout from "../layouts/Layout.astro";

import { getCollection } from "astro:content";
import { cn } from "../lib/utils";

const posts = (await getCollection("blog")).sort(
  (a: { data: { pubDate: number } }, b: { data: { pubDate: number } }) =>
    b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);
---

<Layout>
  <section class="container">
    <h1 class="mb-4">Blog</h1>
    <p class="max-w-prose text-foreground-muted">
      Welcome to my blog! Here, I share insights, tutorials, and case studies on
      web development, UI/UX design, and AI integration. Dive in to explore my
      latest projects and thoughts.
    </p>

    <ul class="grid col-span-4 w-full">
      {
        posts.map(
          (
            post: {
              id: any;
              data: {
                heroImage: string | null | undefined;
                heroAlt: any;
                tags: unknown[];
                title: unknown;
              };
            },
            idx: number
          ) => (
            <li class="my-6 md:my-20">
              <a class="flex flex-col" href={`/blog/${post.id}/`}>
                <div
                  class={cn(
                    "w-full md:w-3/4",
                    idx % 2 === 0 ? "float-left mr-4" : "ml-auto"
                  )}
                >
                  <div class="overlay" />
                  <img
                    src={post.data.heroImage}
                    alt={post.data.heroAlt || "Blog Post Hero Image"}
                  />
                </div>
                <div
                  class={cn(
                    "flex flex-col w-full md:w-3/4",
                    idx % 2 === 0 ? "" : "ml-auto"
                  )}
                >
                  <span class="text-sm my-1 text-foreground-muted">
                    {post.data.tags[0]}
                  </span>
                  <h3 class="text-2xl!">{post.data.title}</h3>
                </div>
              </a>
            </li>
          )
        )
      }
    </ul>
  </section>
</Layout>
