---
import WorkLayout from "../components/WorkLayout.astro";
import { getModuleDataBySlug } from "../data/cms";
import { slugify } from "../lib/utils";

// Get work projects from CMS
const cmsWorkData = getModuleDataBySlug("work");

// Transform CMS data to match expected format
const workPosts = cmsWorkData.map((item) => {
  const data = item.data as Record<string, any>;
  const generatedSlug = data.slug || slugify(data.title || item.id);

  return {
    id: item.id,
    slug: generatedSlug,
    data: {
      title: data.title || "Untitled",
      slug: generatedSlug,
      description: data.description || data.excerpt || "",
      publishedDate: data.published_date || null,
      category: data.category || "",
      heroImage: data.featured_image || "",
      url: data.project_url || "",
      logo: data.logo || "",
      metaTitle: data.title || "Untitled",
      metaDescription: data.description || "",
    },
  };
});
---

<WorkLayout posts={workPosts} />
